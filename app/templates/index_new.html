{% extends "base.html" %}

{% block content %}
<div class="app-container">
    <!-- Chat interface content -->
    <div class="chat-container" id="message-container">
        <div class="welcome-message">
            <h2>Welcome to Free Thinkers</h2>
            <p>Select a model and start chatting with advanced AI models, all running locally on your machine.</p>
            <ul>
                <li>Choose from a variety of models optimized for different tasks</li>
                <li>Adjust parameters to control response style and quality</li>
                <li>Use templates for guided prompting</li>
                <li>Organize and save your conversations</li>
                <li>Upload images for multimodal models</li>
            </ul>
        </div>
    </div>
    
    <!-- Input area -->
    <div class="input-container">
        <div id="token-stats-bar" class="token-stats-bar" style="display: none;">
            <div class="token-stats-item">
                <span>Token count: </span>
                <span id="token-count">0</span> / <span id="max-tokens">2048</span>
                (<span id="token-percentage">0%</span>)
            </div>
        </div>
        <textarea id="message-input" class="form-control" placeholder="Type your message here..." rows="3"></textarea>
        <div class="control-group">
            <div class="primary-controls">
                <button class="btn btn-primary send-btn" id="send-button" disabled>
                    <i class="fas fa-paper-plane"></i> Send
                </button>
                <div class="response-speed-control">
                    <label class="response-speed-label">Speed:</label>
                    <select class="form-select" id="speed-select">
                        <option value="slow">Slow (Best Quality)</option>
                        <option value="medium" selected>Medium (Balanced)</option>
                        <option value="fast">Fast (Lower Quality)</option>
                    </select>
                </div>
            </div>
            <div class="secondary-controls">
                <button class="btn btn-outline-secondary" id="upload-image-btn" style="display: none;">
                    <i class="fas fa-image"></i>
                </button>
                <button class="btn btn-outline-secondary" id="clear-button">
                    <i class="fas fa-trash-alt"></i>
                </button>
            </div>
        </div>
        <div id="character-counter" class="char-counter">0 characters</div>
    </div>
</div>

<!-- Modals -->
<div id="models-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <div id="model-selector-container"></div>
    </div>
</div>

<div id="parameters-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <div id="parameter-controls-container"></div>
    </div>
</div>

<div id="templates-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <div id="template-selector-container"></div>
    </div>
</div>

<div id="history-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <div id="history-container"></div>
    </div>
</div>

<div id="image-upload-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Upload Image</h2>
        <p>Select an image to send to the model. Supported models can analyze and describe images.</p>
        <div class="image-upload-container">
            <div id="upload-preview-container">
                <div id="upload-placeholder">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Drag & drop an image or click to browse</p>
                </div>
                <img id="upload-preview" style="display: none; max-width: 100%; max-height: 300px;">
            </div>
            <input type="file" id="image-file-input" accept="image/*" style="display: none;">
            <div class="form-group" style="margin-top: 20px;">
                <label for="image-prompt">Optional prompt:</label>
                <textarea id="image-prompt" class="form-control" rows="3" placeholder="E.g., 'What's in this image?' or 'Describe this image in detail.'"></textarea>
            </div>
            <div class="upload-actions" style="margin-top: 20px;">
                <button id="select-image-btn" class="btn btn-secondary">Select Image</button>
                <button id="send-image-btn" class="btn btn-primary" disabled>Send to Model</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<!-- Main application scripts -->
<script src="{{ url_for('static', filename='js/conversation_manager.js') }}?v=0.3.0"></script>
<script src="{{ url_for('static', filename='js/model_management.js') }}?v=0.3.0"></script>
<script src="{{ url_for('static', filename='js/parameter_profiler.js') }}?v=0.1.0"></script>
<script src="{{ url_for('static', filename='js/templates.js') }}?v=0.3.0"></script>
<script src="{{ url_for('static', filename='js/main.js') }}?v=0.3.0"></script>
{% endblock %}